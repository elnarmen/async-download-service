# Микросервис для скачивания файлов

Микросервис помогает работе основного сайта, сделанного на CMS и обслуживает
запросы на скачивание архивов с файлами. Микросервис не умеет ничего, кроме упаковки файлов
в архив. Закачиваются файлы на сервер через FTP или админку CMS.

Создание архива происходит на лету по запросу от пользователя. Архив не сохраняется на диске, вместо этого по мере упаковки он сразу отправляется пользователю на скачивание.

От неавторизованного доступа архив защищен хешом в адресе ссылки на скачивание, например: `http://host.ru/archive/3bea29ccabbbf64bdebcc055319c5745/`. Хеш задается названием каталога с файлами, выглядит структура каталога так:

```
- photos
    - 3bea29ccabbbf64bdebcc055319c5745
      - 1.jpg
      - 2.jpg
      - 3.jpg
    - af1ad8c76fda2e48ea9aed2937e972ea
      - 1.jpg
      - 2.jpg
```


## Установка и запуск

Для работы микросервиса нужен Python версии не ниже 3.6.

Склонируйте репозиторий:
```bash
https://github.com/elnarmen/async-download-service.git
```

Скачайте и соберите докер-образы с помощью Docker Сompose:

```shell
$ docker compose pull --ignore-buildable
$ docker compose build
```
Запустите докер-контейнеры и не выключайте:

```shell
docker compose up

[+] Running 1/1
 ✔ Container async_download_service  Recreated                                                                                                              0.2s 
Attaching to async_download_service
async_download_service  | ======== Running on http://0.0.0.0:8080 ========
async_download_service  | (Press CTRL+C to quit)
```

Сервер запустится на порту 8080, чтобы проверить его работу перейдите в браузере на страницу [http://0.0.0.0:8080/](http://0.0.0.0:8080/).<br>
Все файлы из каталога `async-download-service` смонтированы в docker-контейнер, поэтому все изменения кода будут
появляться и в контейнере


# Цели проекта

Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman](https://dvmn.org).